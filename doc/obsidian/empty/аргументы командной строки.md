# аргументы командной строки

Для обработки файла нужно его как-то передать нашей программе. Это делается через аргументы командной строки (`argc`/`argv`):

```Cpp
// src/skelex.cpp
#include "skelex.hpp"
```
```Cpp
/// @brief стандартная точка входа программы,
/// сюда ОС передает управление при запуске программы
/// @param argc количество аргументов, включая имя исполняемого файла программы
/// @param argv массив строк с аргументами `argv[0] = bin/skelex.exe`
/// @return @ref fini @p errorcode
extern int main(int argc, char* argv[]);
```
```Cpp
/// @brief вывод аргумента командной строки при старте системы
/// @details выводится в формате: `argv[argc] = <argv>`
/// @param argc номер аргумента
/// @param argv значение аргумента
extern void arg(int argc, char* argv);
```

Используются два файла -- заголовочный `.hpp` и `.cpp` с С++ кодом: реализацией перечисленных функций. Обычно программы на С/С++
- собираются *из множества отдельных* `.cpp` файлов независимо (**модульная сборка**),
- *каждый модуль компилируется независимо*, и
- компилятор должен знать имена и типы всех используемых функций и структур данных из других модулей

Чтобы это сделать, в каждый модуль нужно подключить через `#include` *декларации* типов, структур и функций. В нашем случае программа очень маленькая и могла бы уместиться в единственный `.cpp`, но
- два модуля создаются автоматически из описания грамматики нашего собственного языка (см. далее),
- сгенерированный код находится в отдельных файлах в каталоге `tmp/`,
- и использует функции, *реализованные* в `src/skelex.cpp`

Логично сделать все декларации в одном и том же общем заголовочном `.hpp`-файле, и подключать только его в каждый из модулей.

```Cpp
// src/skelex.cpp

int main(int argc, char* argv[]) {
    init(argc, argv);
    arg(0, argv[0]);
    for (auto i = 1; i < argc; i++) {
        arg(i, argv[i]);
    }
    return fini(0);
}
```

Цикл `for` начиная с первого аргумента выполняет обработку 1+ файла, имена которых передаются в командной строке. В нашем случае мы только передаем имя только одного скрипта, но вообще можно инициализировать систему, компилируя множество файлов (удобно при редактировании взаимозависимого кода в нескольких окнах).

```Cpp
void arg(int argc, char* argv) {
    cout << "argv[" << argc << "] = <" << argv << ">\n";
}
```

программа компилируется командой:

```shell
g++ -pipe -O0 -g2 -Iinc -Itmp -o bin/skelex src/skelex.cpp
bin/skelex lib/skelex.ini
```
и при запуске выводит список своих аргументов:
```
argv[0] = <bin/skelex>
argv[1] = <lib/skelex.ini>
```
